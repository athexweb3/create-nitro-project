import React, { useCallback, useState } from 'react';
import { StyleSheet, Text, View, ScrollView, Button } from 'react-native';
import { Bench } from 'tinybench';
import { {{className}} } from '{{projectName}}';

export function BenchmarksScreen() {
const [results, setResults] = useState<any[]>([]);
    const [running, setRunning] = useState(false);

    const runBenchmarks = useCallback(async () => {
    setRunning(true);
    const bench = new Bench({ time: 100 });

    bench
    .add('{{className}}.multiply', () => {
    {{className}}.multiply(3, 7);
    })
    .add('JS multiply', () => {
    3 * 7;
    });

    await bench.run();
    setResults(bench.table());
    setRunning(false);
    }, []);

    return (
    <ScrollView contentContainerStyle={styles.container}>
        <Text style={styles.header}>Benchmarks</Text>
        <Button title={running ? "Running..." : "Run Benchmarks" } disabled={running} onPress={runBenchmarks} />
        {results.map((res: any, i) => (
        <View key={i} style={styles.resultItem}>
            <Text style={styles.resultName}>{res['Task Name']}</Text>
            <Text>{Number(res['ops/sec']).toFixed(0)} ops/sec</Text>
        </View>
        ))}
    </ScrollView>
    )
    }

    const styles = StyleSheet.create({
    container: {
    flex: 1,
    alignItems: 'center',
    padding: 20,
    backgroundColor: '#white'
    },
    header: {
    fontSize: 24,
    fontWeight: 'bold',
    marginBottom: 20
    },
    resultItem: {
    marginTop: 10,
    padding: 10,
    backgroundColor: '#f0f0f0',
    borderRadius: 8,
    width: '100%',
    flexDirection: 'row',
    justifyContent: 'space-between'
    },
    resultName: {
    fontWeight: 'bold'
    }
    });